<!DOCTYPE html>
<html lang="el">
<head>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <!-- Firebase App (the core Firebase SDK) -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<link href="https://fonts.googleapis.com/css?family=Lato:400,700&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/snap.svg/0.5.1/snap.svg-min.js"></script>

<!-- Firebase Realtime Database -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>X-GYM Report</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: black;
      color: white;
      background-image: url("https://i.postimg.cc/025nj58G/processed-2-DA30989-5818-4-DF0-A5-A1-A9-A04-F93091-B.jpg");
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      height: 100vh;
      overflow: hidden;
    }

    .overlay {
      position: absolute;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.7);
      z-index: 1;
    }


   /* Όλα τα κουμπιά */
   .dropbtn,
.home-btn {
  position: relative;
  overflow: hidden;
  z-index: 1;
  background: #111;
  color: white;
  padding: 10px 20px;
  min-width: 120px;       /* 👈 Ίδιο πλάτος για όλα */
  text-align: center;   /* 👈 Για ευθυγράμμιση κειμένου */
  border: none;
  border-radius: 8px;
  font-size: 1rem;
  height: 50px;
  cursor: pointer;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
  box-shadow: 0 8px 16px rgba(100, 100, 100, 0.4);
}

/* Το animated μοτίβο */
.dropbtn::before,
.home-btn::before{
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background-image: repeating-linear-gradient(
    45deg,
    rgba(255, 255, 255, 0.05) 0,
    rgba(255, 255, 255, 0.05) 2px,
    transparent 2px,
    transparent 6px
  );
  transform: rotate(0deg);
  opacity: 0;
  transition: opacity 0.4s ease;
  animation: diagonalWaves 4s linear infinite;
  z-index: 0;
  pointer-events: none;
}

.dropbtn:hover::before,
.home-btn:hover::before{
  opacity: 1;
}

.dropbtn:hover,
.home-btn:hover{
  transform: scale(1.05);
  box-shadow: 0 8px 16px rgba(0,0,0,0.6), 0 8px 16px rgba(0,0,0,0.6);
}

/* Keyframes για διαγώνια κίνηση */
@keyframes diagonalWaves {
  0% {
    background-position: 0 0;
  }
  100% {
    background-position: 100px 100px;
  }
}

/* Το κείμενο πάνω από το pattern */
.dropbtn span,
.home-btn span {
  position: relative;
  z-index: 2;
}

    .dropdown {
      position: relative;
    } 

    .dropdown-content {
      position: absolute;
      opacity: 0;
      visibility: hidden;
      position: absolute;
      top: 100%;
      font-size: 16px;
      background-color: #111;
      min-width: 180px;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 8px 16px rgba(100, 100, 100, 0.4);
      z-index: 10;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }

    .dropdown:hover .dropdown-content {
      opacity: 1;
      visibility: visible;
    }

    .dropdown-content button {
      font-size: 0.9rem; 
      background-color: #111;
      color: white;
      padding: 10px;
      width: 100%;
      border: none;
      text-align: left;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }

    .dropdown-content button:hover {
      background-color: #333;
    }

    .content {
      position: relative;
      z-index: 2;
      text-align: center;
      top: 60px;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    #neonText {
  font-size: 3.7rem;
  font-weight: bold;
  text-align: center;
}

    #neonText span {
  display: inline-block;
  color: #00ccff;
  text-shadow:
    0 0 5px #00ccff,
    0 0 10px #00ccff,
    0 0 20px #00ccff,
    0 0 40px #0099ff,
    0 0 80px #0066ff;
  animation: flicker 3s infinite;
}

/* Σβηστό γράμμα */
.flicker-off {
  animation: offFlicker 1s infinite;
  opacity: 0.3;
  text-shadow: none;
}

/* Animation για φυσικό αναβόσβημα */
@keyframes flicker {
  0%, 19%, 21%, 23%, 25%, 54%, 56%, 100% {
    opacity: 1;
  }
  20%, 22%, 24%, 55% {
    opacity: 0.5;
  }
}

@keyframes offFlicker {
  0%, 100% { opacity: 0.3; }
  10%, 90% { opacity: 0.6; }
  50% { opacity: 0.1; }
}

#qrInput {
  font-size: 1.1rem;
  margin-top: 145px;
  padding: 12px 28px;
  width: 440px;               /* πιο μακρύ */
  border: none;
  border-radius: 10px;
  outline: none;
  color: white;
  background: linear-gradient(to right, #222, #444); /* ίδιο με home button */
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.4);          /* ελαφριά σκιά */
  transition: all 0.3s ease;
  text-align: center;
}

#qrInput::placeholder {
  color: rgba(255, 255, 255, 0.5);  /* διακριτικό placeholder */
}

#qrInput:focus {
  transform: scale(1.02);  /* ελαφρύ zoom on focus */
  box-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
}

    .log-entry {
      font-size: 1rem;
      margin: 5px 0;
      display: block;
      text-align: left;
      opacity: 0.9;
      animation: fadeIn 0.4s ease-in-out;
    }

    .checkmark {
      color: #00ff00;
      font-size: 1.2rem;
      margin-right: 8px;
    }

    #log {
      max-height: 300px;
      overflow-y: auto;
      padding-right: 10px;
      width: 320px;
      text-align: left;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes fadeInDown {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes fadeInBackground {
  from {
    opacity: 0;
    background-size: 120%;
  }
  to {
    opacity: 1;
    background-size: 100%;
  }
}
@keyframes showDayLog {
  from {
    opacity: 0;
    transform: translateY(-20px);  /* Ξεκινά από πάνω */
  }
  to {
    opacity: 1;
    transform: translateY(0);  /* Τελική θέση */
  }
}

#dayLogView {
  animation: showDayLog 0.8s ease-out;
}

body {
  transition: background-image 0.5s ease-in-out;
}

.show-day-background {
  animation: fadeInBackground 1s ease-in-out forwards;
}



/* Στυλ για το button */
/* Βασικό στυλ κουμπιών */
.dropbtn,
.home-btn {
  position: relative;
  overflow: hidden;
  z-index: 1;
  background: #111;
  color: white;
  padding: 10px 20px;
  border: none;
  border-radius: 8px;
  font-size: 1rem;
  cursor: pointer;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
  box-shadow: 0 4px 6px rgba(0,0,0,0.4);
}

/* Το geometric pattern layer */
.dropbtn::before,
.home-btn::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background-image: radial-gradient(circle, rgba(255,255,255,0.08) 1px, transparent 1px);
  background-size: 15px 15px;
  transform: rotate(0deg);
  opacity: 0;
  transition: opacity 0.4s ease;
  animation: hexPatternMove 6s linear infinite;
  z-index: 0;
  pointer-events: none;
}
#dailyStatsPage table {
  margin: 0 auto;
  max-width: 800px;
  width: 90%;
  background-color: rgba(0, 0, 0, 0.6);
  color: white;
  border-collapse: collapse;
  border-radius: 12px;
  overflow: hidden;
}

#dailyStatsPage.statistics-page {
  background-image: url('https://i.postimg.cc/pVnx1GJm/IMG-4763-2.jpg');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  width: 100vw;
  height: 100vh;
  margin: 0;
  display: block;
  position: relative;
  z-index: 1;
  padding: 0;
  animation: fadeIn 0.8s ease-in-out;
  overflow-y: auto !important;
  max-height: 100vh;
  height: auto; 
}

#dailyChart {
  width: 100% !important;
  height: auto !important;
  display: block;
  margin: 0 auto;
}

.daily-content {
  background-color: rgba(0, 0, 0, 0.6);
  padding: 2rem;
  border-radius: 12px;
  max-width: 1000px;
  width: 100%;
  text-align: center;
  color: white;
  z-index: 2;
  margin-top: 100px; /* ↑ Κρατά απόσταση από πάνω */
  margin-bottom: 40px;
  
}
#peakHourBox {
  background-color: rgba(255, 255, 255, 0.05);  /* ημιδιαφανές λευκό */
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: white;
  padding: 0.7rem 1.2rem;
  border-radius: 10px;
  font-weight: 500;
  font-size: 1rem;
  margin-top: 20px;
  display: inline-block;
  box-shadow: 0 0 8px rgba(255, 255, 255, 0.1);
}
#totalEntriesBox {
  background-color: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: white;
  padding: 0.7rem 1.2rem;
  border-radius: 10px;
  font-weight: 500;
  font-size: 1rem;
  margin-top: 20px;
  display: inline-block;
  box-shadow: 0 0 8px rgba(0, 0, 0, 0.3);
}

/* Εμφάνιση στο hover */
.dropbtn:hover::before,
.home-btn:hover::before {
  opacity: 1;
}

/* Κινούμενη λάμψη */
.dropbtn:hover,
.home-btn:hover{
  transform: scale(1.05);
  box-shadow: 0 0 10px rgba(255,255,255,0.15), 0 0 30px rgba(255,255,255,0.1);
}

/* Κίνηση pattern */
@keyframes hexPatternMove {
  0% {
    background-position: 0 0;
  }
  100% {
    background-position: 100px 100px;
  }
}

/* Κείμενο πάντα πάνω απ' το pattern */
.dropbtn span,
.home-btn span {
  position: relative;
  z-index: 2;
}

/* Dropdown container */
.dropdown {
  position: relative;
}

/* Dropdown content */
.dropdown-content {
  opacity: 0;
  visibility: hidden;
  position: absolute;
  top: 100%;
  background-color: #111;
  min-width: 180px;
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.6);
  z-index: 10;
  transition: opacity 0.3s ease, visibility 0.3s ease;
}

.dropdown:hover .dropdown-content {
  opacity: 1;
  visibility: visible;
}

/* Button styling inside dropdown */
.dropdown-content button {
  font-size: 0.9rem;
  background-color: #111;
  color: white;
  padding: 10px;
  width: 100%;
  border: none;
  text-align: left;
  cursor: pointer;
  transition: background-color 0.2s ease;
}

/* Hover effect on dropdown buttons */
.dropdown-content button:hover {
  background-color: #333;
}
    /* Εβδομάδες View */
    #weeksView {
      display: none;
      position: absolute;
      top: 0;
      left: 0;
      z-index: 2;
      width: 100%;
      height: 100%;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      background: url('https://i.postimg.cc/ZnFn6ykY/IMG-4159.jpg') no-repeat center center / cover;
      animation: fadeIn 0.8s ease-in-out;
    }

    #todayView {
      display: none;
      position: absolute;
      top: 0;
      left: 0;
      z-index: 2;
      width: 100%;
      height: 100%;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      background: url('https://i.postimg.cc/4NQdC4zX/IMG-4161.jpg') no-repeat center center / cover;
      animation: fadeIn 0.8s ease-in-out;
    }

    #dailyChartContainer {
  width: 100%;
  height: calc(100vh - 100px); /* Adjust based on topbar height */
  padding-top: 100px;
}

    #selectedMonthTitle, #todayTitle {
      font-size: 2rem;
      margin-bottom: 30px;
      background-color: rgba(0, 0, 0, 0.6);
      padding: 10px 20px;
      border-radius: 10px;
    }

    .weeks-grid {
      display: grid;
      grid-template-columns: repeat(2, 200px);
      gap: 30px;
    }

    .weeks-grid button {
      background: linear-gradient(135deg, #222, #444);
      border: none;
      color: white;
      padding: 30px;
      border-radius: 15px;
      font-size: 1.2rem;
      cursor: pointer;
      box-shadow: 0 5px 15px rgba(0,0,0,0.4);
      transition: all 0.3s ease;
    }

    .weeks-grid button:hover {
      background: linear-gradient(135deg, #444, #666);
      transform: translateY(-5px);
    }
 .day-btn {
  background-color: #222;
  color: white;
  padding: 10px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-size: 14px;
  transition: background-color 0.2s ease;
  width: 100%;
}
.day-btn:hover {
  background-color: #444;
}
#backToWeeks {
  background: linear-gradient(to right, #222, #444);
  color: white;
  padding: 10px 20px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.4);
  display: flex;
  justify-content: center;
  align-items: center;
  width: 60px; /* Αυξάνουμε το πλάτος του κουμπιού */
  height: 60px; /* Αυξάνουμε το ύψος του κουμπιού */
}

#backToWeeks svg {
  width: 40px;  /* Ρύθμιση του SVG για το νέο μεγαλύτερο μέγεθος */
  height: 40px;
}

#backToWeeks:hover {
  transform: scale(1.05);
  box-shadow: 0 6px 8px rgba(0, 0, 0, 0.6);  /* Αυξάνει τη σκιά όταν περνάει ο κέρσορας */
}
/* Βασικό στυλ για όλους τους πίνακες */
table {
  width: 90%;
  max-width: 800px;
  margin: 30px auto;
  border-collapse: collapse;
  border-radius: 12px;
  overflow: hidden;
  background: rgba(20, 20, 20, 0.75);
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.6);
  backdrop-filter: blur(4px);
  transition: transform 0.3s ease;
}

table:hover {
  transform: scale(1.01);
}

/* Κεφαλίδες */
thead {
  background: rgba(255, 255, 255, 0.05);
}

th {
  padding: 16px;
  font-size: 1.1rem;
  color: #00ccff;
  text-align: left;
  border-bottom: 1px solid rgba(255, 255, 255, 0.15);
}

/* Γραμμές πίνακα */
td {
  padding: 14px 16px;
  font-size: 1rem;
  color: #e0e0e0;
  border-bottom: 1px solid rgba(255, 255, 255, 0.07);
  transition: background-color 0.2s ease;
}

tr:last-child td {
  border-bottom: none;
}

tr:hover td {
  background-color: rgba(255, 255, 255, 0.05);
}
tbody tr {
  animation: fadeIn 0.6s ease both;
}

tbody tr:nth-child(even) {
  background-color: rgba(255, 255, 255, 0.02);
}
body {
      padding-bottom: 80px;
    }

    html {
      scroll-behavior: smooth;
    }

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: scale(0.97);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

.fade-in {
  animation: fadeIn 0.9s ease forwards;
}
@media (max-width: 600px) {
  table {
    font-size: 0.9rem;
  }

  th, td {
    padding: 10px;
  }
}
.stats-chart-container {
  background: rgba(0, 0, 0, 0.4);
  border: 2px solid rgba(0, 255, 255, 0.5);
  box-shadow: 0 0 20px rgba(0, 255, 255, 0.2);
  border-radius: 20px;
  padding: 1.5rem;
  backdrop-filter: blur(10px);
  animation: fadeIn 1.5s ease-in-out;
}
  .stat-box-container {
  display: flex;
  justify-content: center; /* ✅ Κεντρική στοίχιση */
  gap: 2rem;
  margin-top: 2rem;
  margin-bottom: 3rem;
  flex-wrap: wrap;
}

  .stat-box {
  background-color: rgba(255, 255, 255, 0.1);
  padding: 12px 20px;
  border-radius: 12px;
  font-size: 18px;
  font-weight: bold;
  color: white;
  min-width: 260px;
  text-align: center;
  box-shadow: 0 0 10px rgba(0,0,0,0.4);
  backdrop-filter: blur(3px);
  height: 48px;
  display: flex;
  align-items: center;
  justify-content: center;
}

  @media (max-width: 600px) {
    .stat-box-container {
      flex-direction: column;
    }
  }
  @keyframes fadeSlideIn {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-home {
  animation: fadeSlideIn 0.9s ease;
}
body {
  font-family: 'Lato', sans-serif;
  background-color: #24303a;
  color: white;
  text-align: center;
}

/* Container για τις πίτες */
.charts-row {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: 30px;
  margin-top: 20px;
  margin-bottom: 50px;
  padding: 10px 0;
}

/* Κάθε πίτα */
.chart {
  color: #4a667a;
  background-color: #1e2730;
  margin: 10px;
  padding: 15px 20px 40px 20px;
  box-sizing: border-box;
  text-align: center;
  position: relative;
  display: inline-block;
  width: 300px;
  border-radius: 12px;
}

/* Κάνει τις πίτες responsive */
@media screen and (max-width: 700px) {
  .chart {
    width: 90%;
  }
}

.chart.circle {
  background-color: rgba(20, 30, 40, 0.9);
  color: #4a667a;
  padding: 20px;
  border-radius: 16px;
  text-align: center;
  position: relative;
  width: 280px;
  box-shadow: 0 0 10px rgba(0,0,0,0.4);
}

@media screen and (max-width: 700px) {
  .chart {
    width: calc(100% - 20px);
  }
}

@media screen and (min-width: 700px) {
  .chart {
    width: calc(50% - 20px);
  }
}

.title {
  font-size: 22px;
  color: white;
  margin-bottom: 12px;
}

.chart-circle {
  width: 200px;
  height: 200px;
  transform: rotate(90deg);
  display: block;
  margin: 0 auto;
}

.chart-svg {
  position: relative;
  display: inline-block;
  width: 200px;
  height: 200px;
}

.circle-percentage {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  font-size: 48px;
  color: white;
}

@media screen and (max-width: 700px) {
  .chart.circle {
    width: 90%;
  }
}

.align-center {
  text-align: center;
}

.triangle {
  width: 0;
  height: 0;
  border-style: solid;
  border-width: 28px 0 0 28px;
  position: absolute;
  left: 0;
  bottom: 0;
}

.triangle.green {
  border-color: transparent transparent transparent #48c15e;
}

.triangle.red {
  border-color: transparent transparent transparent #ef6670;
}

.underlay {
  stroke-width: 5;
  fill: transparent;
  stroke-linecap: round;
  stroke-linejoin: round;
  stroke: #24303a;
}
.daily-wrapper {
  display: flex;
  justify-content: center;
  width: 100%;
}
  .chart-svg {
    width: 200px;
    height: 200px;
  }

.chart-svg .circle-percentage {
  position: absolute;
  top: 38%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 32px;
  font-weight: bold;
  color: white;
}

  .chart-circle {
    width: 200px;
    height: 200px;
  }

.underlay {
  fill: none;
  stroke: #1f2a38;
  stroke-width: 10;
}

.overlay {
  fill: none;
  stroke-width: 10;
  stroke-linecap: round;
  transition: stroke-dashoffset 1s ease;
}
.chart.circle.animate .overlay {
  animation: fillCircle 1.5s ease forwards;
}

@keyframes fillCircle {
  from {
    stroke-dashoffset: 282.6;
  }
  to {
    stroke-dashoffset: var(--target-offset);
  }
}
.daily-income-table {
  font-family: 'Red Hat Display', sans-serif;
  font-weight: 400;
  margin: 50px auto;
  perspective: 2000px;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.daily-income-table table {
  border-spacing: 0px;
  width: 680px;
  box-shadow: 5px 4px 30px rgba(0, 0, 0, 0.1);
  border-radius: 10px;
  background: #fff;
  transition: all 0.5s;
  overflow: hidden;
}

.daily-income-table td {
  padding: 20px 15px;
}

.daily-income-table thead {
  background: linear-gradient(45deg, #614ad3, #e42c64);
  border-radius: 10px 10px 0 0;
  color: #fff;
  font-size: 20px;
}

.daily-income-table thead td:first-of-type {
  border-radius: 10px 0 0 0;
}

.daily-income-table thead td:last-of-type {
  border-radius: 0 10px 0 0;
}

.daily-income-table tbody td {
  border-top: 1px solid #f0f0f0;
}

.daily-income-table tbody tr:hover {
  background: rgba(123, 153, 218, 0.1);
}

.daily-income-table button {
  background-color: rgba(20, 30, 40, 0.9); /* ίδιο με πίτες */
  color: #f8f8f8;
  padding: 20px 40px;                     /* πιο μεγάλο κουμπί */
  font-size: 22px;                        /* μεγαλύτερη γραμματοσειρά */
  font-family: 'Red Hat Display', sans-serif;
  font-weight: 600;
  border: none;
  border-radius: 16px;                    /* ίδιο border-radius με πίτες */
  box-shadow: 0 0 10px rgba(0,0,0,0.4);
  margin: 30px auto;
  display: block;
  cursor: pointer;
  transition: background-color 0.3s ease, transform 0.2s ease;
}

.daily-income-table button:hover {
  background-color: rgba(40, 60, 80, 1);   /* πιο έντονο στο hover */
  transform: scale(1.03);
}
#dailyStatsPage::after {
  content: "";
  display: block;
  height: 80px;
}
.daily-income-table table.threeDMode {
  transform: rotateX(65deg) rotateZ(-35deg);
  transition: transform 0.5s ease;
}

    
  </style>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>


<body>

  <div class="overlay"></div>

  <div class="topbar">
    <div class="dropdown" id="monthsDropdown">
      <button id="monthsToggle" class="dropbtn"><span>Μήνες</span></button>
      <div class="dropdown-content" id="monthsMenu" ></div>
    </div>
    <button id="clearYearBtn" class="dropbtn"><span>Καθαρισμός Έτους</span></button>
    <div class="dropdown">
      <button id="Statistics" class="dropbtn"><span>Στατιστικά</span></button>
<div id="statsDropdown" class="dropdown-content">
  <button data-view="daily">Ημερήσια</button>
  <button data-view="weekly">Εβδομαδιαία</button>
  <button data-view="monthly">Μηνιαία</button>
  <button data-view="yearly">Ετήσια</button>
</div>
</div>

    <button class="dropbtn" id="exportCsvBtn"><span>Εξαγωγή CSV</span></button>
    <button class="dropbtn" id="todayBtn"><span>Σήμερα</span></button>
    <button id="homeButton" class="home-btn" title="Αρχική">
      <!-- SVG για το σπιτάκι -->
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="30" height="30" fill="white">
        <path d="M12 3L2 12h3v8h4v-5h6v5h4v-8h3L12 3z"/>
      </svg>
    </button>
  </div>
<div id="dailyStatsPage" class="statistics-page" style="display: none;">
  <div class="daily-wrapper">
    <div class="daily-content">
      <h2>Ημερήσια Στατιστικά Καταγραφών</h2>
      <canvas id="dailyChart" width="2000" height="1000"></canvas>

      <div class="stat-box-container">
        <div id="peakHourBox" class="stat-box">
          <strong>Πιο πολυσύχναστη ώρα:</strong> <span id="peakHourValue">-</span>
        </div>
        <div id="totalEntriesBox" class="stat-box">
          <strong>Συνολικές ημερήσιες καταγραφές:</strong> <span id="totalEntriesValue">-</span>
        </div>
      </div>

      <div class="charts-row">
  <div class="chart circle" id="circle-1">
    <h2 class="title">Ποσοστό ανδρών</h2>
    <div class="chart-svg align-center">
      <h2 class="circle-percentage">77%</h2>
      <svg class="chart-circle" id="chart-3" width="300" height="300" viewBox="0 0 100 100">
        <defs>
          <linearGradient id="gradient-male" x1="1" y1="0" x2="0" y2="1">
            <stop offset="0%" stop-color="#00f9ff"/>
            <stop offset="100%" stop-color="#00ff90"/>
          </linearGradient>
        </defs>
        <circle class="underlay" cx="50" cy="50" r="45" />
        <circle class="overlay" cx="50" cy="50" r="45" stroke="url(#gradient-male)" stroke-dasharray="282.6" stroke-dashoffset="65.0" />
      </svg>
    </div>
    <div class="triangle green"></div>
  </div>

  <div class="chart circle" id="circle-2">
    <h2 class="title">Ποσοστό γυναικών</h2>
    <div class="chart-svg align-center">
      <h2 class="circle-percentage">23%</h2>
      <svg class="chart-circle" id="chart-4" width="300" height="300" viewBox="0 0 100 100">
        <defs>
          <linearGradient id="gradient-female" x1="1" y1="0" x2="0" y2="1">
            <stop offset="0%" stop-color="#8e2de2"/>
            <stop offset="100%" stop-color="#4a00e0"/>
          </linearGradient>
        </defs>
        <circle class="underlay" cx="50" cy="50" r="45" />
        <circle class="overlay" cx="50" cy="50" r="45" stroke="url(#gradient-female)" stroke-dasharray="282.6" stroke-dashoffset="217.6" />
      </svg>
    </div>
    <div class="triangle red"></div>
  </div>
</div>
<div class="daily-income-table">
  <button class="toggle-3d">Ημερήσια έσοδα:100</button>
  <table id="incomeTable">
    <thead>
      <tr>
        <td>ID</td>
        <td>Πελάτης</td>
        <td>Ποσό</td>
      </tr>
    </thead>
      <tbody id="incomeTableBody">
    </tbody>
  </table>
</div>

    </div>
  </div>
</div>

  <div class="content" class="content page" id="mainContent">
    <h1 id="neonText">
      <span>A</span><span>L</span><span>W</span><span>A</span><span>Y</span><span>S</span>&nbsp;
      <span>H</span><span>U</span><span>N</span><span>G</span><span>R</span><span>Y</span>&nbsp;
      <span>F</span><span>O</span><span>R</span>&nbsp;
      <span>M</span><span>O</span><span>R</span><span>E</span>
    </h1>
    <input type="text" id="qrInput" placeholder="Σκάναρε εδώ..." autofocus />
    <div id="log" class="home-content"></div>
  </div>
  <div class="content" class="content page" id="weeksView">
    <h2 id="selectedMonthTitle">Εβδομάδες</h2>
    <div class="weeks-grid" id="weeksDetails">
      <!-- Εβδομάδες θα εμφανιστούν εδώ -->
    </div>
  </div>

  <div class="content" class="content page" id="todayView">
    <h2 id="todayTitle">Σήμερα</h2>
    <div id="todayLog"></div>
  </div>
  <div class="content" class="content page"id="dayLogView" style="display: none;">
  <button id="backToWeeksBtn" style="position: absolute; top: 20px; left: 20px; font-size: 24px; background: none; border: none; color: white; cursor: pointer;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="40" height="40" fill="white">
    <path d="M13.59 6.59L8 12l5.59 5.59L12 19l-7-7 7-7 1.59 1.59z"/>
  </svg>
</button>
  <h2 id="dayLogTitle"></h2>
  <table style="width: 80%; max-width: 600px; background-color: rgba(0,0,0,0.6); border-collapse: collapse; border-radius: 10px; overflow: hidden;">
    <thead>
      <tr>
        <th style="padding: 10px; border-bottom: 1px solid white;">Όνομα</th>
        <th style="padding: 10px; border-bottom: 1px solid white;">Ώρα καταγραφής</th>
      </tr>
    </thead>
    <tbody id="dayLogTableBody"></tbody>
  </table>
</div>

<script>

let todayDate = new Date().toISOString().slice(0, 10);
let storedLog = JSON.parse(localStorage.getItem("logToday"));

if (storedLog && storedLog.date === todayDate) {
  logToday = storedLog;
} else {
  logToday = {
    date: todayDate,
    entries: []
  };
  saveLogData(); // Σώσε νέο log για σήμερα
}
if (!logToday || !logToday.entries) {
  logToday = {
    date: new Date().toLocaleDateString("el-GR"),
    entries: []
  };
}

updateTotalEntriesBox();  // ✅ Εμφανίζει τις σημερινές καταγραφές σωστά μετά το refresh
updateGenderPercentages();

// Φόρτωση δεδομένων από το localStorage για τη σημερινή ημέρα
const storedData = JSON.parse(localStorage.getItem("logToday"));

if (storedData && storedData.date === logToday.date) {
  logToday = storedData;
} else {
  saveLogData(); // Αποθήκευση νέου άδειου αντικειμένου για σήμερα
}

  const monthsMenu = document.getElementById("monthsMenu");
  const dropdown = document.getElementById("monthsDropdown");
  const qrInput = document.getElementById("qrInput");
  const fullText = "Σκάναρε εδώ...";
    let interval;

    function animatePlaceholder() {
      let eraseIndex = fullText.length;

      // 1. Διαγραφή χαρακτήρων
      const erase = setInterval(() => {
        const input = document.querySelector('input');
if (!input) return; // Αν δεν υπάρχει input, δεν κάνουμε τίποτα
input.placeholder = fullText.substring(0, eraseIndex);
        eraseIndex--;

        if (eraseIndex < 0) {
          clearInterval(erase);

          // 2. Εμφάνιση χαρακτήρων
          let typeIndex = 0;
          const type = setInterval(() => {
            input.placeholder = fullText.substring(0, typeIndex + 1);
            typeIndex++;

            if (typeIndex === fullText.length) {
              clearInterval(type);
            }
          }, 100);
        }
      }, 50);
    }

    // Πρώτο κάλεσμα
    animatePlaceholder();

    // Επανάληψη κάθε 8 δευτερόλεπτα
    setInterval(() => {
      animatePlaceholder();
    }, 8000);
  const logContainer = document.getElementById("log");
  const mainContent = document.getElementById("mainContent");
  const weeksView = document.getElementById("weeksView");
  const todayView = document.getElementById("todayView");
  const selectedMonthTitle = document.getElementById("selectedMonthTitle");
  const todayLog = document.getElementById("todayLog");
  const weeksDetails = document.getElementById("weeksDetails");

  const months = ["Ιανουάριος", "Φεβρουάριος", "Μάρτιος", "Απρίλιος", "Μάιος", "Ιούνιος", "Ιούλιος", "Αύγουστος", "Σεπτέμβριος", "Οκτώβριος", "Νοέμβριος", "Δεκέμβριος"];
  const statsBtn = document.getElementById("Statistics");
const dropDown = document.getElementById("statsDropdown");

statsBtn.addEventListener("click", () => {
  dropDown.classList.toggle("show");
});

// Optional: Κλείσιμο dropdown όταν κάνεις κλικ έξω
window.addEventListener("click", (e) => {
  if (!statsBtn.contains(e.target) && !dropDown.contains(e.target)) {
    dropDown.classList.remove("show");
  }
});

// Διαχείριση επιλογής view
dropDown.addEventListener("click", (e) => {
  if (e.target.tagName === "A") {
    const selectedView = e.target.dataset.view;
    console.log("Επιλέχθηκε προβολή:", selectedView);
    // Κάνε κάτι ανάλογα με την επιλογή (π.χ. εμφάνιση στατιστικών)
    dropDown.classList.remove("show");
  }
});


  function getPeriod(hour) {
  if (hour >= 0 && hour < 9) return "Άκυρη Ώρα"; // προαιρετικό
  if (hour >= 9 && hour < 12) return "Πρωί";
  if (hour >= 12 && hour < 18) return "Μεσημέρι";
  if (hour >= 18 && hour <= 23) return "Βράδυ";
  return "Άκυρη Ώρα";
}

  function hideAllViews() {
    mainContent.style.display = "none";
    weeksView.style.display = "none";
    todayView.style.display = "none";
  }


  function closeDropdown() {
    dropdown.classList.remove("open");
  }

  function renderWeeksWithDates(monthName) {
    const year = new Date().getFullYear();
    const monthIndex = months.indexOf(monthName); // 0-based index
    const dates = [];

    const daysInMonth = new Date(year, monthIndex + 1, 0).getDate();

    for (let day = 1; day <= daysInMonth; day++) {
      const date = new Date(year, monthIndex, day);
      dates.push({
        weekday: date.toLocaleDateString("el-GR", { weekday: 'long' }),
        dateStr: date.toLocaleDateString("el-GR"),
        weekNumber: Math.floor((day - 1) / 7) + 1
      });
    }

    const groupedWeeks = {};
    dates.forEach(d => {
      const week = d.weekNumber;
      if (!groupedWeeks[week]) groupedWeeks[week] = [];
      groupedWeeks[week].push(d);
    });

    weeksDetails.innerHTML = ''; // Clear previous content
    Object.entries(groupedWeeks).forEach(([week, days]) => {
      const weekDiv = document.createElement("div");
      weekDiv.classList.add('week-container');

      // Add "Εβδομάδα x"
      const weekTitle = document.createElement("h3");
      weekTitle.textContent = `Εβδομάδα ${week}`;
      weekDiv.appendChild(weekTitle);

      // Add the days inside the week
      const daysContainer = document.createElement("div");
      daysContainer.classList.add('week-days');
      days.forEach(d => {
        const dayDiv = document.createElement("div");
        dayDiv.classList.add('day-box');
dayDiv.innerHTML = `<button class="day-btn" data-date="${d.dateStr}" data-weekday="${capitalizeFirstLetter(d.weekday)}">${capitalizeFirstLetter(d.weekday)} - ${d.dateStr}</button>`;
        daysContainer.appendChild(dayDiv);
      });
      weekDiv.appendChild(daysContainer);

      weeksDetails.appendChild(weekDiv);
    });
  }

  function capitalizeFirstLetter(str) {
    return str.charAt(0).toUpperCase() + str.slice(1);
  }

  document.getElementById("monthsToggle").addEventListener("click", () => {
    dropdown.classList.toggle("open");
  });

  months.forEach(month => {
    const btn = document.createElement("button");
    btn.textContent = month;
    btn.onclick = () => {
      dropdown.classList.remove("open");
      setTimeout(() => {
        hideAllViews();
        weeksView.style.display = "flex";
        selectedMonthTitle.textContent = `Εβδομάδες - ${month}`;
        renderWeeksWithDates(month);
weeksDetails.addEventListener("click", function(e) {
if (e.target.matches(".day-btn")) {
  const selectedDate = e.target.dataset.date;
  const weekday = e.target.dataset.weekday;
  showDayLog(selectedDate, weekday);
}
});
      }, 300);
    };
    monthsMenu.appendChild(btn);
  });

  document.getElementById("homeButton").addEventListener("click", () => {
  hideAllViews();

  // Εφαρμόζουμε animation στην αρχική
  mainContent.classList.remove("animate-home"); // Για να επαναλάβει το animation
  void mainContent.offsetWidth; // Force reflow
  mainContent.classList.add("animate-home");

  mainContent.style.display = "block";  // Επιστρέφουμε στο αρχικό μενού
  qrInput.focus();  // Επιστρέφουμε το focus στο πεδίο εισαγωγής

  document.body.style.backgroundImage = "url('https://i.postimg.cc/025nj58G/processed-2-DA30989-5818-4-DF0-A5-A1-A9-A04-F93091-B.jpg')";
  document.body.classList.remove('show-day-background');
  dayLogView.style.display = "none";
});

document.getElementById("todayBtn").addEventListener("click", () => {
  hideAllViews();
  todayView.style.display = "flex";
  document.getElementById("dayLogView").style.display = "none";
  todayLog.innerHTML = "";
    console.log("📦 logToday.entries =", logToday.entries);


  const grouped = { Πρωί: [], Μεσημέρι: [], Βράδυ: [] };
  logToday.entries.forEach(entry => {
  if (grouped[entry.period]) {
    grouped[entry.period].push(entry);
  } else {
    console.warn("❌ Άγνωστο period:", entry.period, entry);
  }
});

  ["Πρωί", "Μεσημέρι", "Βράδυ"].forEach(period => {
    if (grouped[period].length) {
      const h3 = document.createElement("h3");
      h3.textContent = period;
      todayLog.appendChild(h3);

      const table = document.createElement("table");
      table.style.width = "100%";
      table.style.backgroundColor = "rgba(0, 0, 0, 0.6)";
      table.style.borderCollapse = "collapse";
      table.style.borderRadius = "10px";
      table.style.overflow = "hidden";

      const thead = document.createElement("thead");
      const headerRow = document.createElement("tr");
      const nameHeader = document.createElement("th");
      nameHeader.textContent = "Όνομα";
      nameHeader.style.padding = "10px";
      nameHeader.style.borderBottom = "1px solid white";
      const timeHeader = document.createElement("th");
      timeHeader.textContent = "Ώρα καταγραφής";
      timeHeader.style.padding = "10px";
      timeHeader.style.borderBottom = "1px solid white";

      headerRow.appendChild(nameHeader);
      headerRow.appendChild(timeHeader);
      thead.appendChild(headerRow);
      table.appendChild(thead);

     const tbody = document.createElement("tbody");
     grouped[period].forEach(entry => {
  const row = document.createElement("tr");

  const nameCell = document.createElement("td");
  nameCell.textContent = entry.name;
  nameCell.style.padding = "10px";

  const timeCell = document.createElement("td");
  timeCell.textContent = entry.time;
  timeCell.style.padding = "10px";

  row.appendChild(nameCell);
  row.appendChild(timeCell);
  tbody.appendChild(row);
});

      table.appendChild(tbody);
      todayLog.appendChild(table);
    }
  });
});
document.getElementById("qrInput").addEventListener("keydown", (e) => {
  if (e.key === "Enter") {
    const qrInput = document.getElementById("qrInput");
    const qrText = qrInput.value.trim();
    if (!qrText) return;

    // ✨ Ανάλυση QR σε ID;NAME;GENDER
    const parts = qrText.split(";");
    if (parts.length !== 3) {
      alert("❌ Αλλάξτε την γλώσσα πληκτρολογίου στα Αγγλικά");
      qrInput.value = "";
      return;
    }

    const [rawId, rawName, rawGender] = parts;

    const id = rawId.replace(/^ID=/i, "").trim();
    const name = rawName.replace(/^NAME=/i, "").trim().toUpperCase();
    const gender = rawGender.replace(/^GENDER=/i, "").trim().toUpperCase();

    const now = new Date();
    const hour = now.getHours();
    const minutes = now.getMinutes().toString().padStart(2, "0");
    const time = `${hour}:${minutes}`;
    const dateStr = now.toLocaleDateString("el-GR");
    const dayPeriod = getPeriod(hour);

    // ➕ Καταγραφή για το "Σήμερα"
    logToday.entries.push({ id, name, gender, period: dayPeriod, time });
    updateTotalEntriesBox();
    updateGenderPercentages();
    saveLogData();

    // ➕ Καταγραφή στα mockData για την Ημέρα
    if (!mockData[dateStr]) mockData[dateStr] = [];
    mockData[dateStr].push({ id, name, gender, time });
    saveData();

    // 🔄 Καθάρισμα input
    qrInput.value = "";
    qrInput.focus();

    // ❌ Αφαίρεση μηνύματος "Καμία καταγραφή"
    const noEntriesMessage = document.querySelector("#todayLog p");
    if (logToday.entries.length > 0 && noEntriesMessage) {
      noEntriesMessage.remove();
    }

    // 🔁 Ανανεώνουμε πίτα/γράφημα (αν χρειάζεται)
    renderDailyChart?.();
  }
});

function saveData() {
localStorage.setItem("attendanceData", JSON.stringify(mockData));
}
//const dayLogView = document.getElementById("dayLogView");
const dayLogTitle = document.getElementById("dayLogTitle");
const dayLogTableBody = document.getElementById("dayLogTableBody");
const backToWeeksBtn = document.getElementById("backToWeeksBtn");

// Προσωρινά δεδομένα (παράδειγμα)
// Μόνιμα δεδομένα από localStorage ή ξεκίνημα από κενό
let mockData = JSON.parse(localStorage.getItem("attendanceData")) || {};

backToWeeksBtn.addEventListener("click", () => {
console.log("Πίσω πατήθηκε!"); 
dayLogView.style.display = "none";
weeksView.style.display = "flex";
dayLogTitle.textContent="";
dayLogTableBody.innerHTML="";
});

  function renderLog() {
    logContainer.innerHTML = "";
    logToday.forEach(entry => {
      const div = document.createElement("div");
      div.className = "log-entry";
      div.innerHTML = `<span class="checkmark">✅</span> ${entry.name}`;
      logContainer.appendChild(div);
    });
  }



  setInterval(() => {
  const todayStr = new Date().toISOString().slice(0, 10);
  if (logToday.date !== todayStr) {
    logToday.date = todayStr;
    logToday.entries = [];
    saveLogData();
    console.log("🕛 Νέα ημέρα - Καθαρίστηκε το σημερινό log.");
  }
}, 60000); // Τρέχει κάθε λεπτό

  function showDayLog(dateStr, weekday) {
hideAllViews();  // Κρύβουμε όλες τις άλλες προβολές

// Ορίζουμε το φόντο της σελίδας για την ημέρα
document.body.style.backgroundImage = "url('https://i.postimg.cc/fTzz0MNw/IMG-4164.jpg')";  // Βάλε την εικόνα σου εδώ
document.body.classList.add('show-day-background');  // Ενεργοποιούμε το animation του φόντου

dayLogView.style.display = "flex";  // Εμφανίζουμε το πινακάκι της ημέρας
dayLogTitle.textContent = `${capitalizeFirstLetter(weekday)} - ${dateStr}`;  // Ο τίτλος της ημέρας

const tbody = dayLogTableBody;
tbody.innerHTML = "";  // Καθαρίζουμε τον πίνακα

const logs = mockData[dateStr] || [];  // Χρησιμοποιούμε mockData ή πραγματικά δεδομένα

logs.forEach(log => {
  const row = document.createElement("tr");
  row.innerHTML = `
    <td style="padding: 10px; border-bottom: 1px solid #ccc;">${log.name}</td>
    <td style="padding: 10px; border-bottom: 1px solid #ccc;">${log.time}</td>
  `;
  tbody.appendChild(row);
});

document.getElementById("exportCsvBtn").addEventListener("click", () => {
if (!mockData || Object.keys(mockData).length === 0) {
  alert("Δεν υπάρχουν καταγραφές για εξαγωγή.");
  return;
}

let csvContent = "Ημερομηνία,Όνομα,Ώρα Καταγραφής\n";

Object.entries(mockData).forEach(([date, entries]) => {
  entries.forEach(entry => {
    csvContent += `${date},"${entry.name}",${entry.time}\n`;
  });
});

const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
const url = URL.createObjectURL(blob);

const link = document.createElement("a");
link.setAttribute("href", url);
link.setAttribute("download", "Καταγραφές.csv");
document.body.appendChild(link);
link.click();
document.body.removeChild(link);
});
}

function saveLogData() {
  localStorage.setItem("logToday", JSON.stringify(logToday));}


document.getElementById("clearYearBtn").addEventListener("click", () => {
// Ερώτηση επιβεβαίωσης
if (confirm("Είστε σίγουροι ότι θέλετε να καθαρίσετε όλα τα δεδομένα του έτους;")) {
  // Καθαρίζουμε το mockData (όλες οι καταγραφές των ημερών του έτους)
  mockData = {};

  // Καθαρίζουμε τις καταγραφές του σημερινού
  logToday.entries = [];

  // Καθαρίζουμε το localStorage (να μην παραμείνουν τα δεδομένα αποθηκευμένα)
  localStorage.removeItem("logToday");

  // Ανανέωση της προβολής "Σήμερα"
  todayLog.innerHTML = "";  // Καθαρίζουμε τα δεδομένα της προβολής "Σήμερα"

  // Ενημέρωση μηνύματος στο "Σήμερα"
  const noEntriesMessage = document.createElement("p");
  noEntriesMessage.textContent = "Δεν υπάρχουν καταγραφές για σήμερα.";
  todayLog.appendChild(noEntriesMessage);

  alert("Όλα τα δεδομένα του έτους έχουν καθαριστεί!");
}
});
const letters = document.querySelectorAll("#neonText span");

setInterval(() => {
  const randomIndex = Math.floor(Math.random() * letters.length);
  const letter = letters[randomIndex];

  // Εναλλαγή flicker effect για "χαλασμένο" γράμμα
  letter.classList.add("flicker-off");
  setTimeout(() => {
    letter.classList.remove("flicker-off");
  }, 800 + Math.random() * 1200);
}, 300);

document.querySelector('[data-view="daily"]').addEventListener("click", () => {
  // Κλείνουμε το dropdown άμεσα
  dropDown.classList.remove("show");

  // Κρύβουμε τις άλλες προβολές
  hideAllViews();
  document.getElementById("dailyStatsPage").style.display = "flex";

const labels = [
  "09:00", "10:00", "11:00", "12:00", "13:00", "14:00",
  "15:00", "16:00", "17:00", "18:00", "19:00", "20:00",
  "21:00", "22:00", "23:00"
];

const counts = new Array(labels.length).fill(0);
scheduleMidnightReset();

if (logToday.entries && logToday.entries.length > 0) {
  logToday.entries.forEach(entry => {
    let hour = NaN;

    // ✅ Αν είναι HH:MM μορφή
    if (typeof entry.time === "string" && entry.time.includes(":")) {
      const parts = entry.time.split(":");
      hour = parseInt(parts[0]);
    }

    // ✅ Υπολογισμός slot
    const index = hour - 9;
    if (!isNaN(hour) && index >= 0 && index < counts.length) {
      counts[index]++;
    }
  });
}

const ctx = document.getElementById("dailyChart").getContext("2d");

if (window.dailyChartInstance) {
  window.dailyChartInstance.data.datasets[0].data = counts;
  window.dailyChartInstance.update();
} else {
  window.dailyChartInstance = new Chart(ctx, {
    type: "bar",
    data: {
      labels: labels,
      datasets: [{
        label: "Αριθμός Καταγραφών",
        data: counts,
        backgroundColor: "rgba(0, 200, 255, 0.7)",
        borderRadius: 6
      }]
    },
    options: {
      responsive: true,
      scales: {
        y: {
          beginAtZero: true,
          min: 0,
          max: 30,
          ticks: { stepSize: 3 },
          title: { display: true, text: "Καταγραφές" }
        },
        x: {
          title: { display: true, text: "Ώρα" }
        }
      }
    }
  });
}

// ➕ Υπολογισμός πιο πολυσύχναστης ώρας
const maxCount = Math.max(...counts);
const peakIndex = counts.indexOf(maxCount);
let peakHour = "-";

if (typeof labels !== 'undefined' && typeof peakIndex !== 'undefined' && Array.isArray(labels) && labels.length > peakIndex) {
  peakHour = labels[peakIndex] || "-";
}

const peakEl = document.getElementById("peakHourValue");
if (peakEl) {
  peakEl.textContent = peakHour;
}
});

// Ενημέρωση του πλαισίου
document.getElementById("peakHourValue").textContent = peakHour;

// ✅ ΝΕΟΣ σωστός υπολογισμός μόνο για τη σημερινή ημερομηνία
const today = new Date().toISOString().slice(0, 10); // Μορφή "YYYY-MM-DD"
const todaysEntries = logToday.entries.filter(entry => {
  const entryDate = new Date(entry.time).toISOString().slice(0, 10);
  return entryDate === today;
});

// 🔐 Firebase config (όπως το είχες)
const firebaseConfig = {
  apiKey: "AIzaSyBcwXllrv82qw6o7FCwgJL2_qNGheLNit0",
  authDomain: "xgym-b5623.firebaseapp.com",
  databaseURL: "https://xgym-b5623-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "xgym-b5623",
  storageBucket: "xgym-b5623.appspot.com",
  messagingSenderId: "269441169531",
  appId: "1:269441169531:web:ff6633493eb25a73f4cade",
  measurementId: "G-G7ZT57CELS"
};

  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);

  // Get a reference to the database
  const db = firebase.database();

  function scheduleMidnightReset() {
  const now = new Date();
  const midnight = new Date();
  midnight.setHours(24, 0, 0, 0); // Απόψε στις 00:00

  const msUntilMidnight = midnight.getTime() - now.getTime();

  setTimeout(() => {
    // Μηδενίζουμε τις εγγραφές
    logToday.entries = [];

    // Αδειάζουμε και τα counts για το διάγραμμα
    for (let i = 0; i < counts.length; i++) {
      counts[i] = 0;
    }

    // Ενημερώνουμε chart αν υπάρχει
    if (window.dailyChartInstance) {
      window.dailyChartInstance.data.datasets[0].data = counts;
      window.dailyChartInstance.update();
    }

    // Ενημέρωση στατιστικού πίνακα
    updateTotalEntriesBox();
    updateGenderPercentages();

    // Ενημέρωση localStorage
    saveLogData();

    // Προγραμματισμός για την επόμενη μέρα
    scheduleMidnightReset();
  }, msUntilMidnight);
}
function updateTotalEntriesBox() {
  document.getElementById("totalEntriesValue").textContent = logToday.entries.length;
}
function updateGenderPercentages() {
  const entries = logToday.entries;
  const total = entries.length;

  let maleCount = 0;
  let femaleCount = 0;

  for (const entry of entries) {
    if (entry.gender === "MALE") maleCount++;
    else if (entry.gender === "FEMALE") femaleCount++;
  }

  const malePercent = total === 0 ? 0 : Math.round((maleCount / total) * 100);
  const femalePercent = total === 0 ? 0 : 100 - malePercent;

  // 🔄 Ενημέρωση κειμένου
  document.querySelector("#circle-1 .circle-percentage").textContent = `${malePercent}%`;
  document.querySelector("#circle-2 .circle-percentage").textContent = `${femalePercent}%`;

  // 🔄 Ενημέρωση stroke-dashoffset
  const fullLength = 2 * Math.PI * 45; // = 282.6 περίπου
  const maleOffset = fullLength * (1 - malePercent / 100);
  const femaleOffset = fullLength * (1 - femalePercent / 100);

  document.querySelector("#circle-1 .overlay").setAttribute("stroke-dashoffset", maleOffset);
  document.querySelector("#circle-2 .overlay").setAttribute("stroke-dashoffset", femaleOffset);
}
function showPage(pageId) {
  const allPages = ["mainContent", "weeksView", "todayView", "dailyStatsPage", "dayLogView"];
  allPages.forEach(id => {
    const el = document.getElementById(id);
    if (el) el.style.display = (id === pageId) ? "block" : "none";
  });

  // Επαναφορά scroll στην αρχή κάθε σελίδας
  window.scrollTo(0, 0);
}

document.addEventListener("DOMContentLoaded", () => {
  // Κουμπί "Αρχική"
  const homeBtn = document.getElementById("homeButton");
  if (homeBtn) homeBtn.addEventListener("click", () => showPage("mainContent"));

  // Κουμπί "Σήμερα"
  const todayBtn = document.getElementById("todayBtn");
  if (todayBtn) todayBtn.addEventListener("click", () => showPage("todayView"));

  // Κουμπί "Στατιστικά > Ημερήσια"
  const statsDailyBtn = document.querySelector('button[data-view="daily"]');
  if (statsDailyBtn) statsDailyBtn.addEventListener("click", () => showPage("dailyStatsPage"));

  // Κουμπί "Μήνες" => δείχνει τις εβδομάδες (weeksView)
  const monthsToggle = document.getElementById("monthsToggle");
  if (monthsToggle) monthsToggle.addEventListener("click", () => showPage("weeksView"));
});
function drawCircle(container,id,progress,parent){
  var paper = Snap(container);
  var prog = paper.path("M5,50 A45,45,0 1 1 95,50 A45,45,0 1 1 5,50");
  var lineL = prog.getTotalLength();
  var oneUnit = lineL/100;
  var toOffset = lineL - oneUnit * progress;
  var myID = 'circle-graph-'+id;
  prog.attr({
    'stroke': '#0f0',
    'stroke-width': 5,
    'fill': 'none',
    'stroke-dashoffset':lineL,
    'stroke-dasharray':lineL,
    'id':myID
  });
  
  var animTime = 1300/*progress / 100*/
  
  prog.animate({
    'stroke-dashoffset':toOffset
  },animTime,mina.easein);
  
  function countCircle(animtime,parent,progress){
    var textContainer = $(parent).find('.circle-percentage');
    var i = 0;
    var time = 1300;
    var intervalTime = Math.abs(time / progress);
    var timerID = setInterval(function () {
      i++;
      textContainer.text(i+"%");
      if (i === progress) clearInterval(timerID);
    }, intervalTime);           
  }
  countCircle(animTime,parent,progress);
  console.log("Drawing", container, "with", progress + "%");
}

$(window).on('load',function(){
    drawCircle('#chart-3',1,77,'#circle-1');
    drawCircle('#chart-4',2,53,'#circle-2');
});
$(document).ready(function () {
    $('.daily-income-table .toggle-3d').on('click', function () {
      $('.daily-income-table table').toggleClass('threeDMode');
    });
  });
  async function loadDailyIncome() {
    console.log("🔄 Εκτελείται loadDailyIncome()");
    try {
      const response = await fetch("https://script.googleusercontent.com/macros/echo?user_content_key=AehSKLhWNDQK3Cxl2Zye5ccWMaNznnE2bNB3CMN4zNScRS9Rf_fmd76T3vXAUpZC9ATyXWmoeYx9nLWGow_1Aop3fc9X5MWOSj1hHpCKnrSoe_ZWtZxW0NH9-nq0JQ_6RVhUeSZz26-H-V9QKL9dzEM_jz-p6a3b1MshHdAKJ_5pzx7izbOg8l1_fPexzmv94Qd_u8vSKOf-4rTpdWIwh76pVRa8sL6-oCLtQbJjgXIXdKOQpY5AABihwsUSqweygxscxx0BnvzUxUkYZ7cnuFwCNoFJAw0PkTFHxMJ1_896&lib=My2nLZva7mpJirll2OPzxTeuSGo6RNCzChttps://script.google.com/macros/s/AKfycbx9W56zUkBxMUWtl6cKfpmzgKbICWVqUXkyA9c2-rjLbeoTLvwcxgJZZezk8mNSMgvygw/exec");
      const data = await response.json();

      const tbody = document.getElementById("incomeTableBody");
      tbody.innerHTML = ""; // Καθαρίζει τον πίνακα

      let total = 0;

      data.forEach(entry => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${entry.id}</td>
          <td>${entry.name}</td>
          <td>${entry.amount}</td>
        `;
        tbody.appendChild(row);
        total += parseFloat(entry.amount);
      });

      document.querySelector(".toggle-3d").textContent = `Ημερήσια έσοδα: ${total} €`;
    } catch (err) {
      console.error("❌ Σφάλμα κατά το fetch:", err);
    }
  }

  window.addEventListener("DOMContentLoaded", loadDailyIncome);
</script>

</script>

<style>
/* Ορίζουμε το ύψος και τη θέση της κορυφαίας μπάρας */
.topbar {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  background-color: rgba(0, 0, 0, 0.7);
  color: white;
  padding: 10px;
  z-index: 9999;
  display: flex;
  justify-content: center;
  gap: 20px;
  animation: fadeInDown 0.6s ease;
}
.topbar button:hover {
  background-color: #222;
}

/* Ρυθμίζουμε το ύψος της κύριας περιεχομένου */
.content {
  margin-top: 70px; /* Αφήνουμε χώρο για τη μπάρα */
  overflow: auto;
  padding: 20px;
}

/* Η περιοχή που περιέχει τις εβδομάδες */
.weeks-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr); /* 2 εβδομάδες δίπλα-δίπλα */
  gap: 20px; /* Κενό ανάμεσα στις εβδομάδες */
  margin-top: 20px;
  overflow-y: auto; /* Αν το περιεχόμενο ξεπερνά την οθόνη, να μπορεί να γίνει κύλιση */
  max-height: 80vh; /* Όριο ύψους για το περιεχόμενο */
}

/* Οι εβδομάδες με το μαύρο κουτάκι */
.week-container {
  background-color: rgba(0, 0, 0, 0.7); /* Μαύρο φόντο */
  padding: 15px;
  border-radius: 8px;
  color: white; /* Λευκά γράμματα */
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
}

.week-container h3 {
  text-align: center;
  margin-bottom: 10px;
  font-size: 18px;
}

/* Οι μέρες για κάθε εβδομάδα */
.week-days-container {
  background-color: rgba(0, 0, 0, 0.8); /* Μαύρο διάφανο φόντο για τις ημέρες */
  padding: 10px;
  border-radius: 5px;
  display: flex;
  flex-direction: column; /* Κατακόρυφη διάταξη */
  gap: 10px;
  justify-content: center;
  align-items: center;
}

.day-box {
  background-color: black;
  color: white;
  padding: 10px;
  border-radius: 5px;
  font-size: 16px;
  text-align: center;
  width: 100%;
  margin-bottom: 5px;
}

/* Ρυθμίζουμε το μήκος των εβδομάδων και των ημερών */
.week-container .week-days-container .day-box {
  width: auto; /* Το πλάτος του κουτιού να είναι αυτό που χρειάζεται για την ημέρα */
}

/* Περιορίζουμε το ύψος της σελίδας */
html, body {
  height: 100%;
  margin: 0;
  padding: 0;
}

/* Επιτρέπει κύλιση μόνο αν το περιεχόμενο ξεπερνά την οθόνη */
body {
  overflow: hidden;
}

.content {
  overflow-y: scroll;
  max-height: calc(100vh - 70px); /* Όριο ύψους για να μην ξεπερνά την οθόνη */
}
</style>

</body>

</html>